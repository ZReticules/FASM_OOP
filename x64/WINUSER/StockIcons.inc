importlib Shell32,\
	SHGetStockIconInfo

struct SHSTOCKICONINFO
	cbSize			dq sizeof.SHSTOCKICONINFO
	hIcon			dq ?
	iSysImageIndex	dd ?
	iIcon			dd ?
	szPath 			dw MAX_PATH dup(?)
ends

define SHGSI_ICONLOCATION  0
define SHGSI_ICON          256
define SHGSI_SYSICONINDEX  16384
define SHGSI_LINKOVERLAY   32768
define SHGSI_SELECTED      65536
define SHGSI_LARGEICON     0
define SHGSI_SMALLICON     1
define SHGSI_SHELLICONSIZE 4

SIID enum\
	DOCNOASSOC,\
	DOCASSOC,\
	APPLICATION,\
	FOLDER,\
	FOLDEROPEN,\
	DRIVE525,\
	DRIVE35,\
	DRIVEREMOVE,\
	DRIVEFIXED,\
	DRIVENET,\
	DRIVENETDISABLED,\
	DRIVECD,\
	DRIVERAM,\
	WORLD,\
	MYNETWORK_0,\
	SERVER,\
	PRINTER,\
	MYNETWORK,\
	MULTIMONITOR,\;18
	FOLDERSHARP,\
	DOCTIME,\
	CONTROL_PANNEL,\
	FIND,\
	HELP,\
	BLUEPRLG,\
	NIGHTMONITOR,\;26
	USBGREENARROW,\
	REDALERT,\
	SHARE,\
	LINK,\
	SLOWFILE,\
	RECYCLER,\
	RECYCLERFULL,\;33
	STRANGEFOLDER,\
	BLUESCREEN,\
	CONTROL_PANNEL_0,\
	FOLDERSHARP_0,\
	PRINTERFOLDER,\
	FOLDERA,\
	ROUTER,\
	MEDIACDAUDIO = 40,\
	TREE,\
	FOLDERPC,\
	STAR,\
	KEY,\
	FOLDER_GREEN_ARROW,\
	MONITOR_DOUBLEGREEN,\
	LOCK = 47,\
	APP_PC,\
	AUTOLIST = 49,\
	PRINTERNET,\
	SERVERSHARE,\
	PRINTERFAX,\
	PRINTERFAXNET,\
	PRINTERFILE,\
	STACK,\
	MEDIASVCD,\
	STUFFEDFOLDER,\
	DRIVEUNKNOWN,\
	DRIVEDVD,\
	MEDIADVD,\
	MEDIADVDRAM,\
	MEDIADVDRW,\
	MEDIADVDR,\
	MEDIADVDROM,\
	MEDIACDAUDIOPLUS,\
	MEDIACDRW,\
	MEDIACDR,\
	MEDIACDBURN,\
	MEDIABLANKCD,\
	MEDIACDROM,\
	AUDIOFILES,\
	IMAGEFILES,\
	VIDEOFILES,\
	MIXEDFILES,\
	FOLDERBACK,\
	FOLDERFRONT,\
	SHIELD,\
	WARNING,\
	INFO,\
	ERROR,\
	KEY,\
	SOFTWARE,\
	RENAME,\
	DELETE,\
	MEDIAAUDIODVD,\
	MEDIAMOVIEDVD,\
	MEDIAENHANCEDCD,\
	MEDIAENHANCEDDVD,\
	MEDIAHDDVD,\
	MEDIABLURAY,\
	MEDIAVCD,\
	MEDIADVDPLUSR,\
	MEDIADVDPLUSRW,\
	DESKTOPPC,\
	MOBILEPC,\
	USERS,\
	MEDIASMARTMEDIA,\
	MEDIACOMPACTFLASH,\
	DEVICECELLPHONE,\
	DEVICECAMERA,\
	DEVICEVIDEOCAMERA,\
	DEVICEAUDIOPLAYER,\
	NETWORKCONNECT,\
	INTERNET,\
	ZIPFILE,\
	SETTINGS,\
	DRIVESYS,\
	APPMEDIA,\
	MUSIC,\
	IMAGE,\
	MEDIAPLAYER,\
	FOLDER_0,\
	DRIVENET_0,\
	SCHEMA,\
	BLACKRECT,\
	CANVAS,\
	DRIVENETENABLED,\
	DRIVECDENABLED,\
	PRINTERNETENABLED,\
	PRINTERENABLED,\
	PRINTERFAXENABLED,\
	NOTEBOOKSHEET,\
	BRAND,\
	IMAGEWHITE,\
	MUSICWHITE,\
	MEDIAPLAYER_2.0,\
	COMMUNITY,\
	SHIELDQUESTION,\
	SHIELDCANCEL,\
	SHIELDOK,\
	SHIELDWARNING,\
	DRIVEHDDVD = 132,\
	DRIVEBD,\
	MEDIAHDDVDROM,\
	MEDIAHDDVDR,\
	MEDIAHDDVDRAM,\
	MEDIABDROM,\
	MEDIABDR,\
	MEDIABDRE,\
	CLUSTEREDDRIVE,\
	SERVERDRIVE,\
	MUSICWHITE_0 = 163,\
	DRIVEUNLOCK,\
	DRIVELOCK,\
	DRIVEUNLOCKWARNING,\
	DRIVEUNLOCKSYSTEM,\
	DRIVEUNLOCKSYSTEMWARNING,\
	DRIVEUNLOCK_0,\
	DRIVELOCK_0,\
	DOCFOLDER,\
	OK,\
	PLAY,\
	FOLDEREMPTY,\
	FOLDER_1,\
	FOLDERFILL,\
	LOCK_0,\
	TWO_ARROWS,\
	CASE,\
	MAX_ICONS = 181

proc_noprologue

proc WND.getStockIcon, ICONID
	local stockInfo:SHSTOCKICONINFO
	@call [SHGetStockIconInfo](rcx, SHGSI_ICON or SHGSI_ICONLOCATION, addr stockInfo) 
	mov edx, 0
	test eax, eax
	cmovnz eax, edx
	jnz .error
		mov rax, [stockInfo.hIcon]
	.error:
	ret
endp

proc_resprologue